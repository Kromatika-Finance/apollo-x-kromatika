(self.webpackChunkcloud_onchain_trade_sdk=self.webpackChunkcloud_onchain_trade_sdk||[]).push([[3289],{3421:(e,i,t)=>{"use strict";var s;t.d(i,{VH:()=>l}),e=t.hmd(e),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&s(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var n,o,r="{{rootDomain}}",a="{{network}}";function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;return e?e.replace(a,i):e}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(n.register(".","DOT","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),n.register(r,"ROOT_DOMAIN","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),n.register(a,"NETWORK","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),n.register((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=null!=i&&i.hostname?i.hostname:window.location.hostname,s=t.split(".");return s.length>2?s.slice(-e).join("."):t}),"getLevelDomain","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),n.register((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;return e?e.replace(r,i):e}),"replaceDomian","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),n.register(l,"replaceNetwork","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js")),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&o(e)},42249:(e,i,t)=>{"use strict";t.d(i,{h:()=>a});var s=t(33075),n=t(51616),o=t(52983),r=t(95386);const a=()=>{const{selectedNetworkId:e}=(0,s.o6)(),i=(0,n.xx)({chainId:e});return(0,o.useMemo)((()=>r.yw[i]||{}),[i])}},2203:(e,i,t)=>{"use strict";t.d(i,{F:()=>x,K:()=>y});var s=t(11273),n=t(58395),o=t(5837),r=t(33740),a=t(76933),l=t(17921),c=t(52983),d=t(29543),u=t(95386),m=t(49506),p=t(49382),g=t(69464);const y={Close:1,CancelLimit:2,Open:3},f=({hash:e,onClose:i})=>{const{useHistoryDetail:t,getI18n:s}=(0,c.useContext)(g.C),{useHistoryDetailSymbol:o,useHistoryDetailType:r}=t(),{symbol:a,isLong:l,symbolName:d}=o(e),{i18n:u}=r(e);return(0,c.useMemo)((()=>c.createElement("div",{className:"flex items-center justify-between mb-4"},c.createElement("div",{className:"text-t-primary text-subtitle1"},d||a," ",l?s("orderForm-long","Long"):s("orderForm-short","Short")," -  ",u),c.createElement(n.E,{width:"20px",height:"20px",fontSize:"20px",className:"cursor-pointer absolute right-4 text-t-third",onClick:i}))),[s,u,l,i,a,d])},v=({hash:e})=>{const{getI18n:i,useHistoryDetail:t,staticHost:s}=(0,c.useContext)(g.C),{useHistoryDetailLeverage:n,useHistoryDetailSymbol:o,useHistoryDetailPNLROI:r}=t(),a=n(e),{symbolType:l}=o(e),{isPNLNegative:d,isPNLPositive:u}=r(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-leverage","Leverage")},c.createElement("div",{className:"flex items-center gap-1"},a,c.createElement(p.b,{staticHost:s,symbolType:l,isPNLNegative:d,isPNLPositive:u})))},h=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailInitialMargin:s}=t(),n=s(e),o=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-initialMargin-tips01","Initial Margin is the margin initially allocated to this position.")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line mt-3"},i("userinfo-dialog-detail-history-initialMargin-tips02","Initial Margin = Principal - Open Fee")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-initialMargin","Initial Margin"),tips:o,showLabelSx:!0},n)},b=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailQtyAndSize:s,useHistoryDetailPair:n}=t(),{baseAsset:o}=n(e),{size:r,qty:a}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-qty","QTY(Size)")},a," ",o," ( ≈ ",r," USD )")},P=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailPrice:s}=t(),{entryPrice:n}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-entryPrice","Entry Price")},n," USD")},L=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailPrice:s}=t(),{closePrice:n}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-closePrice","Close Price")},n," USD")},N=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailLiqLostRate:s}=t(),n=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-liquidLostRate","Liquid Lost Rate")},`${new l.Z(n).multipliedBy(100).toFixed(2)}%`)},O=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailFundingFee:s}=t(),{fundingFee:n,isFundingFeeNegative:o}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-accFundingFee","Acc. Funding Fee")},c.createElement("div",{className:"text-subtitle2",style:{color:o?"var(--colors-t-sell)":"var(--colors-t-buy)"}},n))},w=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailPNLROI:s}=t(),{PNL:n,isPNLNegative:o}=s(e),r=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-realizedPnl-tips01","Realized PNL only calculates the profit and loss generated after the position is successfully opened.")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line mt-3"},i("userinfo-dialog-detail-history-realizedPnl-tips02-v2","Long : Realized PNL = (Close Price - Entry Price) * Qty + Funding Fee")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-realizedPnl-tips03-v2","Short : Realized PNL = (Entry Price - Close Price ) * Qty + Funding Fee")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-realizedPnl","Realized PNL"),tips:r,showLabelSx:!0},c.createElement("div",{className:"text-subtitle2",style:{color:o?"var(--colors-t-sell)":"var(--colors-t-buy)"}},n))},E=({hash:e})=>{const{getI18n:i,useHistoryDetail:t,enableShare:s,ee:n}=(0,c.useContext)(g.C),{useHistoryDetailPNLROI:r}=t(),{ROI:a,isROINegative:l}=r(e),d=(0,c.useCallback)((()=>n.emit("MODAL_POSITION_SHARE_OPEN",{hash:e,overlay:!0})),[n,e]),u=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-realizedROI-tips01","Realized ROI = Realized PNL / Initial margin * 100%")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-realizedROI","Realized ROI"),tips:u,showLabelSx:!0},c.createElement("div",{className:"text-subtitle2",style:{color:l?"var(--colors-t-sell)":"var(--colors-t-buy)"}},a),s&&c.createElement("div",null,c.createElement(o.f,{className:"relative ml-0.5 cursor-pointer text-t-third",width:"16px",height:"16px",fontSize:"16px",onClick:d})))},F=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailOpenCloseFee:s}=t(),{openFee:n}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-openFee","Open Fee")},n)},B=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailOpenCloseFee:s}=t(),{closeFee:n,isDynamicClosingFee:o}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-closeFee","Close Fee")},c.createElement("div",{className:"flex flex-col"},n,o?c.createElement("div",{className:"text-caption1 text-t-secondary text-right"},c.createElement(d.c,{i18nKey:"userinfo-close-fee-based-pnl",defaults:i("userinfo-close-fee-based-pnl","Charge based on PNL <viewMoreLink>View</viewMoreLink>"),components:{viewMoreLink:c.createElement("a",{href:u.WO,className:"text-t-link hover:text-t-linkHover",target:"_blank",rel:"noreferrer"})}})):null))},M=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailOpenCloseFee:s}=t(),{executionFee:n}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-executionFee","Execution Fee")},n)},T=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailNetProfit:s}=t(),{netProfit:n,isNetProfitNegative:o}=s(e),r=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-netProfit-tips01","Net Profit is the profit and loss obtained after taking into account the trader's principal and trading fees.")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line mt-3"},i("userinfo-dialog-detail-history-netProfit-tips02-v2","Net Profit = Realized PNL - Open Fee - Execution Fee - Close Fee")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-netProfit","Net Profit"),tips:r,showLabelSx:!0},c.createElement("div",{className:"text-subtitle2",style:{color:o?"var(--colors-t-sell)":"var(--colors-t-buy)"}},n))},_=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailDuration:s}=t(),{time:n}=s(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-time","Time")},n)},S=({hash:e})=>c.createElement("div",{className:"flex flex-col gap-6 max-h-[80vh] overflow-auto lg:h-[unset] lg:overflow-hidden lg:flex-row"},c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4"},c.createElement(v,{hash:e}),c.createElement(h,{hash:e}),c.createElement(b,{hash:e}),c.createElement(P,{hash:e}),c.createElement(L,{hash:e}),c.createElement(N,{hash:e}),c.createElement(O,{hash:e}),c.createElement(w,{hash:e}),c.createElement(E,{hash:e})),c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4 bg-interactive-interactive01 dark:bg-interactive-interactive01 rounded-[10px] p-[16px] h-[max-content] "},c.createElement(F,{hash:e}),c.createElement(M,{hash:e}),c.createElement(B,{hash:e}),c.createElement(T,{hash:e}),c.createElement("div",{className:"border-b-[var(--colors-border-line)] border-b border-solid"}),c.createElement(_,{hash:e}))),D=({hash:e})=>c.createElement("div",{className:"flex flex-col overflow-auto gap-6 max-h-[80vh]  lg:h-[unset] lg:overflow-hidden lg:flex-row"},c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4"},c.createElement(v,{hash:e}),c.createElement(h,{hash:e}),c.createElement(b,{hash:e}),c.createElement(P,{hash:e}),c.createElement(N,{hash:e})),c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4 bg-interactive-interactive01 dark:bg-interactive-interactive01 rounded-[10px] p-[16px] h-[max-content] "},c.createElement(F,{hash:e}),c.createElement(M,{hash:e}),c.createElement(_,{hash:e}))),I=({hash:e})=>c.createElement("div",{className:"flex max-h-[80vh] overflow-auto lg:max-h-[unset lg:overflow-hidden"},c.createElement("div",{className:"flex flex-col w-full gap-4"},c.createElement(_,{hash:e}))),k=({hash:e,onClose:i})=>{const{useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailType:s}=t(),{type:n}=s(e);return n===y.CancelLimit?c.createElement("div",{className:"history-detail-content w-full sm:w-[368px]"},c.createElement(f,{hash:e,onClose:i}),c.createElement(I,{hash:e})):c.createElement("div",{className:"history-detail-content w-full sm:w-[718px]"},c.createElement(f,{hash:e,onClose:i}),n===y.Close&&c.createElement(S,{hash:e}),n===y.Open&&c.createElement(D,{hash:e}))},x=()=>{const{ee:e}=(0,c.useContext)(g.C),[i,t]=(0,c.useState)(""),{isMobile:n}=(0,s.F)(),o=(0,c.useCallback)((()=>{t("")}),[]),l=(0,c.useCallback)((({hash:e})=>{t(e)}),[]);return(0,c.useEffect)((()=>(e.on("MODAL_HISTORY_DETAIL_OPEN",l),e.on("MODAL_HISTORY_DETAIL_CLOSE",o),()=>{e.off("MODAL_HISTORY_DETAIL_OPEN",l),e.off("MODAL_HISTORY_DETAIL_CLOSE",o)})),[e,o,l]),n?c.createElement(r.yo,{open:Boolean(i)},c.createElement(r.ue,{side:"bottom",className:"w-full border-none p-4 pb-6 rounded-t-[4px] bg-interactive-interactiveBg z-tooltip",onPointerDownOutside:o},c.createElement(k,{hash:i,onClose:o}))):c.createElement(a.Vq,{open:Boolean(i)},c.createElement(a.PK,null,c.createElement(a.cZ,{className:"p-4",onPointerDownOutside:o},c.createElement(k,{hash:i,onClose:o}))))}},69464:(e,i,t)=>{"use strict";t.d(i,{C:()=>s});const s=t(52983).createContext({})},49382:(e,i,t)=>{"use strict";t.d(i,{b:()=>o});var s=t(8429),n=t(52983);const o=({symbolType:e,isPNLNegative:i,isPNLPositive:t,staticHost:o})=>{const r=(0,n.useMemo)((()=>i?`${o}/static/images/degen-mode/degen-negative-pnl.svg`:t?`${o}/static/images/degen-mode/degen-positive-pnl.svg`:`${o}/static/images/degen-mode/degen-neutral.svg`),[i,t,o]);return(0,s.L)(e).isDegenMode?n.createElement("img",{src:r,width:"20px",height:"20px"}):null}},49506:(e,i,t)=>{"use strict";t.d(i,{Z:()=>l});var s=t(27618),n=t(52983),o=t(32142);const r=({label:e,showLabelSx:i,tips:t})=>(0,n.useMemo)((()=>{const s=n.createElement("div",{className:"text-t-secondary text-subtitle2 border-dashed border-b sm:border-none",style:{borderBottomColor:i?"var(--colors-t-secondary)":"transparent"}},e);return t?n.createElement(o.e,{tip:t},s):s}),[i,e,t]),a=e=>n.createElement("div",Object.assign({},e,{className:(0,s.cn)("flex items-center text-subtitle2 text-t-primary",e.className)})),l=({label:e,showLabelSx:i=!1,children:t,tips:s})=>(0,n.useMemo)((()=>n.createElement("div",{className:"flex items-top justify-between"},n.createElement(r,{tips:s,label:e,showLabelSx:i}),n.createElement(a,null,t))),[s,e,i,t])},84542:(e,i,t)=>{"use strict";t.d(i,{Tw:()=>o,pT:()=>n});const s=new Map([[56,{name:"BNB Chain",iconUrlPath:"/static/images/wallet/bsc-logo.svg",color:"#F0B90B",apiNetwork:"bnb"}],[97,{name:"BNB Testnet",iconUrlPath:"/static/images/wallet/bsc-logo.svg",color:"#F0B90B",apiNetwork:"bnb-testnet"}],[42161,{name:"Arbitrum",iconUrlPath:"/static/images/wallet/arb-logo.svg",color:"#28A0F0",apiNetwork:"arbitrum"}],[421613,{name:"Arbitrum Goerli",iconUrlPath:"/static/images/wallet/arb-logo.svg",color:"#28A0F0",apiNetwork:"arbitrum-goerli"}],[204,{name:"opBNB",iconUrlPath:"/static/images/wallet/bsc-logo.svg",color:"#F0B90B",apiNetwork:"opBNB"}],[5611,{name:"opBNB Testnet",iconUrlPath:"/static/images/wallet/bsc-logo.svg",color:"#F0B90B",apiNetwork:"opBNBTestnet"}],[8453,{name:"Base",iconUrlPath:"/static/images/wallet/base-logo.svg",color:"#3a7aff",apiNetwork:"base"}],[84531,{name:"Base Goerli",iconUrlPath:"/static/images/wallet/base-logo.svg",color:"#3a7aff",apiNetwork:"base-goerli"}]]),n=e=>{if(e)return s.get(e)},o=(e,i)=>{var t,s,o;return null!==(o=null!==(s=null===(t=n(e))||void 0===t?void 0:t.name)&&void 0!==s?s:i)&&void 0!==o?o:""}},5837:(e,i,t)=>{"use strict";t.d(i,{f:()=>n});var s=t(52983);const n=e=>s.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",...e},s.createElement("path",{d:"M9 14.5A6.5 6.5 0 0115.5 8h1.672l-2.586 2.586L16 12l5-5-5-5-1.414 1.414L17.172 6H15.5A8.5 8.5 0 007 14.5V17h2v-2.5z",fill:"currentColor"}),s.createElement("path",{d:"M19 15h2v6H3v-6h2v4h14v-4z",fill:"currentColor"}))},89479:(e,i,t)=>{var s=1/0,n="[object Symbol]",o="\\ud800-\\udfff",r="\\u0300-\\u036f\\ufe20-\\ufe23",a="\\u20d0-\\u20f0",l="\\ufe0e\\ufe0f",c="["+o+"]",d="["+r+a+"]",u="\\ud83c[\\udffb-\\udfff]",m="[^"+o+"]",p="(?:\\ud83c[\\udde6-\\uddff]){2}",g="[\\ud800-\\udbff][\\udc00-\\udfff]",y="\\u200d",f="(?:"+d+"|"+u+")?",v="["+l+"]?",h=v+f+"(?:"+y+"(?:"+[m,p,g].join("|")+")"+v+f+")*",b="(?:"+[m+d+"?",d,p,g,c].join("|")+")",P=RegExp(u+"(?="+u+")|"+b+h,"g"),L=RegExp("["+y+o+r+a+l+"]"),N="object"==typeof t.g&&t.g&&t.g.Object===Object&&t.g,O="object"==typeof self&&self&&self.Object===Object&&self,w=N||O||Function("return this")();function E(e){return L.test(e)}var F=Object.prototype.toString,B=w.Symbol,M=B?B.prototype:void 0,T=M?M.toString:void 0;function _(e){return null==e?"":function(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&F.call(e)==n}(e))return T?T.call(e):"";var i=e+"";return"0"==i&&1/e==-s?"-0":i}(e)}var S=("toUpperCase",function(e){var i,t,s,n,o=E(e=_(e))?function(e){return E(e)?function(e){return e.match(P)||[]}(e):function(e){return e.split("")}(e)}(e):void 0,r=o?o[0]:e.charAt(0),a=o?(i=o,t=1,n=i.length,s=void 0===s?n:s,!t&&s>=n?i:function(e,i,t){var s=-1,n=e.length;i<0&&(i=-i>n?0:n+i),(t=t>n?n:t)<0&&(t+=n),n=i>t?0:t-i>>>0,i>>>=0;for(var o=Array(n);++s<n;)o[s]=e[s+i];return o}(i,t,s)).join(""):e.slice(1);return r.toUpperCase()+a});e.exports=function(e){return S(_(e).toLowerCase())}},58851:(e,i,t)=>{"use strict";t.d(i,{b2:()=>N,ch:()=>w,Xi:()=>_,RM:()=>S,yT:()=>T,uq:()=>D,v_:()=>I,iA:()=>x,a6:()=>C,r2:()=>Z,D:()=>R,k6:()=>a,uN:()=>le,zV:()=>l,g8:()=>c,xK:()=>Pe,ZC:()=>m,Fc:()=>y,kD:()=>p,PC:()=>g,Gn:()=>u});var s=t(52983),n=t(67387),o=t(25048);const r=(0,t(76748).Ue)((e=>({initialed:!1,history:[],historyMap:{},appendHistory(i){e((0,o.ZP)((e=>{e.initialed=!0,e.history=[...e.history,...i.map((e=>e.hash))],e.historyMap=Object.assign(Object.assign({},e.historyMap),i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.hash]:i})),{}))})))},resetHistory(){e((0,o.ZP)((e=>{e.initialed=!1,e.history=[],e.historyMap={}})))},tab:"",setTab(i){e((0,o.ZP)((e=>{e.tab=i})))},predictionInitialed:!1,predictionLoading:!1,predictionHasMore:!0,predictionPage:0,predictions:[],predictionMap:{},setPredictionLoading(i){e((0,o.ZP)((e=>{e.predictionLoading=i})))},setPredictionHasMore(i){e((0,o.ZP)((e=>{e.predictionHasMore=i})))},setPredictionPage(i){e((0,o.ZP)((e=>{e.predictionPage=i})))},refreshPrediction(i){e((0,o.ZP)((e=>{e.predictionInitialed&&!e.predictionLoading&&(e.predictions=[...i.map((e=>e.positionHash))],e.predictionMap=Object.assign({},i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.positionHash]:i})),{})))})))},appendPrediction(i){e((0,o.ZP)((e=>{e.predictionInitialed=!0,e.predictionHasMore=0!==i.length,e.predictions=[...e.predictions,...i.map((e=>e.positionHash))],e.predictionMap=Object.assign(Object.assign({},e.predictionMap),i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.positionHash]:i})),{}))})))},resetPrediction(){e((0,o.ZP)((e=>{e.predictionInitialed=!1,e.predictionLoading=!1,e.predictionHasMore=!0,e.predictionPage=0,e.predictions=[],e.predictionMap={}})))}}))),a=()=>r((e=>e.history)),l=()=>r((e=>e.initialed)),c=()=>[r((e=>e.tab)),r((e=>e.setTab))],d=(e,i)=>r((t=>{var s,n;return null===(n=null===(s=t.historyMap)||void 0===s?void 0:s[e])||void 0===n?void 0:n[i]})),u=()=>r((e=>e.predictions)),m=(e,i)=>r((t=>{var s,n;return null===(n=null===(s=t.predictionMap)||void 0===s?void 0:s[e])||void 0===n?void 0:n[i]})),p=()=>r((e=>e.predictionInitialed)),g=()=>r((e=>e.predictionLoading)),y=()=>r((e=>e.predictionHasMore));var f=t(42249);const v=e=>{const i=d(e,"margin"),t=d(e,"tokenSymbol"),o=(0,f.h)()[t]||t,r=(0,n.RK)(o),a=!!t;return(0,s.useMemo)((()=>({initialed:a,symbol:t,margin:i,qtyPrecision:r})),[a,t,i,r])},h=e=>{const{symbol:i}=v(e),t=(0,n.Ms)(i);return(0,s.useMemo)((()=>t),[t])};var b=t(30883),P=t(17921);const L=e=>{const i=d(e,"openFee"),t=d(e,"closeFee"),n=d(e,"fundingFee"),o=d(e,"executionFee"),r=d(e,"holdingFee");return(0,s.useMemo)((()=>({openFee:i,closeFee:t,fundingFee:n,executionFee:o,holdingFee:r})),[t,o,n,r,i])},N=e=>{const i=d(e,"actionType"),t=(0,f.h)(),{openFee:n,closeFee:o,executionFee:r}=L(e),{initialed:a,symbol:l,qtyPrecision:c}=v(e);return(0,s.useMemo)((()=>{let e=new P.Z("-");return"OPEN"===i&&(e=new P.Z(n).plus(r)),"CLOSE"!==i&&"TP"!==i&&"SL"!==i&&"LIQUIDATED"!==i||(e=new P.Z(o)),"CANCEL_LIMIT"!==i&&"SYSTEM_CANCEL"!==i||(e=new P.Z("-")),a&&e.isFinite()?`${(0,b.uf)(e,c)} ${t[l]||l}`:"-"}),[i,o,r,a,n,l,c,t])},O=e=>{const i=v(e),{symbol:t,index:n}=h(e);return(0,s.useMemo)((()=>Object.assign(Object.assign({},i),{initialed:i.initialed&&void 0!==t,margin:new P.Z(i.margin).multipliedBy(n)})),[n,i,t])},w=e=>{const i=(e=>{const i=d(e,"qty"),t=d(e,"entryPrice"),{margin:n,initialed:o}=O(e);return(0,s.useMemo)((()=>o?new P.Z(i).multipliedBy(t).dividedBy(n):new P.Z(1/0)),[t,o,n,i])})(e);return(0,s.useMemo)((()=>i.isFinite()?`${i.toFixed(1)}x`:"-"),[i])};var E=t(89479),F=t.n(E),B=t(96988);const M=e=>{const i=d(e,"actionType"),t=d(e,"entryPrice"),n=d(e,"closePrice");return(0,s.useMemo)((()=>"CANCEL_LIMIT"===i||"SYSTEM_CANCEL"===i?"-":"OPEN"===i?t:"LIQUIDATED"===i||"TP"===i||"SL"===i||"CLOSE"===i?n:"-"),[i,n,t])},T=e=>{const i=d(e,"pair"),t=M(e),o=(0,n.fV)(i);return(0,s.useMemo)((()=>{const e=new P.Z(t);return e.isFinite()?(0,b.uf)(e,o):"-"}),[t,o])},_=e=>{const i=d(e,"actionType"),t=d(e,"side"),n=d(e,"qty"),o=d(e,"pair"),r=d(e,"timestamp"),{getI18n:a}=(0,B.V6)(),l=M(e),c=T(e),{symbol:u,qtyPrecision:m}=v(e),p=(0,s.useMemo)((()=>{const e=new P.Z(n).multipliedBy(l);return e.isFinite()?(0,b.uf)(e,m):"-"}),[l,n,m]),g=(0,s.useMemo)((()=>"CANCEL_LIMIT"===i||"SYSTEM_CANCEL"===i),[i]),y=(0,s.useMemo)((()=>{const e=(0,b.Bv)(Number(r));return(0,b.Bv)().diff(e,"hour")>24?e.format("YYYY-MM-DD"):e.format("HH:mm:ss")}),[r]);return(0,s.useMemo)((()=>({side:a(`userinfo-history-side-${t.toUpperCase()}`,F()(t))||F()(t),symbol:o,price:c,size:p,isCancelOrSystemCancel:g,timeFormat:y,marginToken:u})),[c,a,g,o,t,p,y,u])},S=e=>{const i=(0,f.h)(),t=d(e,"pnl"),n=d(e,"actionType"),{fundingFee:o,holdingFee:r}=L(e),{initialed:a,margin:l,symbol:c,qtyPrecision:u}=v(e);return(0,s.useMemo)((()=>{const e=i[c]||c;if("CLOSE"===n||"LIQUIDATED"===n||"TP"===n||"SL"===n){const i=new P.Z(t).plus(o).minus(r),s=new P.Z(i).dividedBy(l),n=(0,b.uf)(i,u),c=`${(0,b.uf)(s.multipliedBy(100),2)}%`;return{PNL:a&&i.isFinite()?i.isNegative()?`${n} ${e}`:`+${n} ${e}`:"-",PNLNFormat:a&&i.isFinite()?i.isNegative()?(0,b.pF)(i.toNumber(),u):`+${(0,b.pF)(i.toNumber(),u)}`:"-",ROI:a&&s.isFinite()?s.isNegative()?c:`+${c}`:"-",isPNLNegative:i.isNegative(),isROINegative:s.isNegative(),tokenInSymbol:e}}return{PNL:"-",ROI:"-",isPNLNegative:void 0,isROINegative:void 0,PNLNFormat:"-",tokenInSymbol:e}}),[n,o,r,a,l,t,u,c,i])},D=e=>{const{getI18n:i}=(0,B.V6)(),t=d(e,"side");return(0,s.useMemo)((()=>i(`userinfo-history-side-${t.toUpperCase()}`,F()(t))||F()(t)),[i,t])},I=e=>{const i=d(e,"qty"),t=d(e,"entryPrice"),n=d(e,"closePrice"),o=d(e,"actionType");return(0,s.useMemo)((()=>{let e=new P.Z("-");return"OPEN"===o&&(e=new P.Z(t).multipliedBy(i)),"CLOSE"!==o&&"SL"!==o&&"TP"!==o&&"LIQUIDATED"!==o||(e=new P.Z(n).multipliedBy(i)),e.isFinite()?(0,b.uf)(e.toFixed(1),1):"-"}),[o,n,t,i])};var k=t(98277);const x=e=>{const i=d(e,"pair"),t=d(e,"isLong"),{productMap:n}=(0,k.GS)();return(0,s.useMemo)((()=>{var e,s;return{symbol:i,isLong:t,symbolType:null===(e=n[i])||void 0===e?void 0:e.symbolType,symbolName:null===(s=n[i])||void 0===s?void 0:s.symbolName}}),[i,t,n])},C=e=>{const i=d(e,"timestamp");return(0,s.useMemo)((()=>(0,b.Bv)(Number(i)).isValid()?(0,b.Bv)(Number(i)).format("MM-DD HH:mm:ss"):"-"),[i])},Z=e=>{const i=d(e,"actionType"),{getI18n:t}=(0,B.V6)();return(0,s.useMemo)((()=>i?t(`userinfo-history-type-${i.toUpperCase()}`,{defaultValue:i.toUpperCase()}):"-"),[t,i])};var H=t(17845);const R=()=>({useHistoryTab:c,fetchPredictions:()=>{H.ee.emit("FETCH_DUMB_HISTORY_LIST",void 0)},usePredictionDataByFiled:m,usePredictionHasMore:y,usePredictionInitialed:p,usePredictionLoading:g,usePredictions:u,usePricePrecision:n.fV,useAssetPrecision:n.RK});var A=t(95386),$=t(49229),U=t(51616),q=t(83719);const j=e=>{const i=(0,q.E)(),{data:t}=(0,U.do)(Object.assign(Object.assign({},i),{functionName:"pairsV4",staleTime:1/0,scopeKey:"pairs"}));return(0,s.useMemo)((()=>{var i;return(null===(i=(t||[]).find((i=>i.name.replace("/","")===e)))||void 0===i?void 0:i.base)||""}),[t,e])},G=e=>{const i=d(e,"qty"),t=d(e,"pair"),o=j(t),r=d(e,"entryPrice"),a=(0,s.useMemo)((()=>new P.Z(i).multipliedBy(r)),[r,i]),l=(0,n.tz)(o,a);return(0,s.useMemo)((()=>(0,$.mb)(null==l?void 0:l.liqLostP,A.cB.percent)),[l])},V=e=>{const i=d(e,"timestamp"),{getI18n:t}=(0,B.V6)();return(0,s.useMemo)((()=>(0,b.jE)(Number(i),t)),[i,t])},z=e=>{const{openFee:i,executionFee:t,fundingFee:n,closeFee:o,holdingFee:r}=L(e),{symbol:a,index:l}=h(e);return(0,s.useMemo)((()=>({initialed:void 0!==a,openFee:new P.Z(i).multipliedBy(l),closeFee:new P.Z(o).multipliedBy(l),fundingFee:new P.Z(n).multipliedBy(l),executionFee:new P.Z(t).multipliedBy(l),holdingFee:new P.Z(r).multipliedBy(l)})),[a,i,l,o,n,t,r])},Y=e=>{const i=(0,f.h)(),{fundingFee:t,holdingFee:n}=L(e),{fundingFee:o,holdingFee:r}=z(e),{symbol:a,qtyPrecision:l}=v(e);return(0,s.useMemo)((()=>{const e=new P.Z(t).minus(n);return{fundingFee:`${e.isNegative()?"":"+"}${(0,b.FL)(e,l)} ${i[a]||a} ( ≈ ${(0,b.uf)(new P.Z(o).minus(r),2)} USD )`,isFundingFeeNegative:e.isNegative()}}),[t,n,l,a,o,r,i])},Q=e=>{const i=(0,f.h)(),{margin:t,symbol:n,qtyPrecision:o}=v(e),{margin:r}=O(e);return(0,s.useMemo)((()=>`${(0,b.FL)(t,o)} ${i[n]||n} ( ≈ ${(0,b.uf)(r,1)} USD )`),[t,o,n,r,i])};var K=t(2203);const J=["CLOSE","TP","SL","LIQUIDATED"],W=["CANCEL_LIMIT","SYSTEM_CANCEL"],X=["OPEN"],ee=e=>{const{getI18n:i}=(0,B.V6)(),t=d(e,"actionType"),n=i(`userinfo-history-type-${null==t?void 0:t.toUpperCase()}`,{defaultValue:null==t?void 0:t.toUpperCase()}),o=(0,s.useMemo)((()=>[{types:J,type:K.K.Close},{types:X,type:K.K.Open},{types:W,type:K.K.CancelLimit}]),[]);return(0,s.useMemo)((()=>Object.assign(Object.assign({},o.find((e=>e.types.includes(null==t?void 0:t.toUpperCase())))||{type:void 0}),{i18n:n})),[t,n,o])},ie=e=>{const i=(0,f.h)(),t=d(e,"pnl"),{margin:n,symbol:o,qtyPrecision:r}=v(e),a=d(e,"actionType"),{fundingFee:l}=L(e),{index:c}=h(e);return(0,s.useMemo)((()=>{const e=i[o]||o;if(J.includes(a)){const i=new P.Z(t).plus(l),s=new P.Z(i).dividedBy(n),o=(0,b.FL)(i,r),a=`${(0,b.uf)(s.multipliedBy(100),2)}%`,d=i.isNegative(),u=i.isPositive(),m=s.isNegative();return{PNL:i.isFinite()?`${d?"":"+"}${o} ${e} ( ≈ ${(0,b.uf)(i.multipliedBy(c),1)} USD\n        )`:"-",PNLOrigin:i,PNLFormatted:o,ROI:s.isFinite()?`${m?"":"+"}${a}`:"-",isPNLNegative:d,isROINegative:m,isPNLPositive:u,tokenInSymbol:e}}return{PNL:"-",PNLOrigin:new P.Z(0),PNLFormatted:"-",ROI:"-",isPNLNegative:!1,isROINegative:!1,isPNLPositive:!1,tokenInSymbol:e}}),[a,l,c,n,t,r,o,i])},te=e=>{const{PNLOrigin:i}=ie(e),{openFee:t,executionFee:s,closeFee:n}=L(e);return i.minus(t).minus(s).minus(n)},se=e=>{const i=(0,f.h)(),{symbol:t,qtyPrecision:n}=v(e),o=te(e),r=(e=>{const i=te(e),{index:t}=h(e);return i.multipliedBy(t)})(e);return(0,s.useMemo)((()=>({netProfit:o.isNaN()?"-":`${o.isNegative()?"":"+"}${(0,b.FL)(o.toNumber(),n)} ${i[t]||t} ( ≈ ${(0,b.uf)(r,1)} USD )`,isNetProfitNegative:o.isNegative()})),[o,n,t,r,i])},ne=e=>{const i=(0,f.h)(),{openFee:t,closeFee:o,executionFee:r}=L(e),{openFee:a,closeFee:l,executionFee:c}=z(e),u=d(e,"pair"),m=j(u),{data:p}=(0,n.Bu)(m),{symbol:g,qtyPrecision:y}=v(e);return(0,s.useMemo)((()=>{var e,s;return{isDynamicClosingFee:Boolean(p.feeConfig&&(null===(e=p.feeConfig)||void 0===e?void 0:e.shareP)>0&&(null===(s=p.feeConfig)||void 0===s?void 0:s.minCloseFeeP)>0),openFee:`${(0,b.FL)(new P.Z(t),y)} ${i[g]||g} ( ≈ ${(0,b.uf)(a,2)} USD )`,executionFee:`${(0,b.FL)(new P.Z(r),y)} ${i[g]||g} ( ≈ ${(0,b.uf)(c,2)} USD )`,closeFee:`${(0,b.FL)(o,y)} ${i[g]||g} ( ≈ ${(0,b.uf)(l,2)} USD )`}}),[p.feeConfig,t,y,g,a,r,c,o,l,i])},oe=e=>{const i=d(e,"pair"),t=(0,k.Lh)(i,"baseAsset");return(0,s.useMemo)((()=>({pair:i,baseAsset:t})),[i,t])},re=e=>{const i=d(e,"pair"),t=d(e,"entryPrice"),o=d(e,"closePrice"),r=(0,n.fV)(i);return(0,s.useMemo)((()=>({entryPrice:new P.Z(t).isFinite()?(0,b.uf)(t,r):"-",closePrice:new P.Z(o).isFinite()?(0,b.uf)(o,r):"-"})),[t,r,o])},ae=e=>{const i=I(e),t=d(e,"qty"),n=d(e,"pair"),o=(0,k.Lh)(n,"quantityPrecision");return(0,s.useMemo)((()=>({size:i,qty:(0,b.uf)(t,o)})),[t,o,i])},le=()=>(0,s.useMemo)((()=>({useHistoryDetailType:ee,useHistoryDetailPair:oe,useHistoryDetailLeverage:w,useHistoryDetailInitialMargin:Q,useHistoryDetailSymbol:x,useHistoryDetailQtyAndSize:ae,useHistoryDetailFundingFee:Y,useHistoryDetailOpenCloseFee:ne,useHistoryDetailPrice:re,useHistoryDetailLiqLostRate:G,useHistoryDetailPNLROI:ie,useHistoryDetailNetProfit:se,useHistoryDetailDuration:V})),[]);var ce=t(76398),de=t(19260),ue=t(33075),me=t(87576),pe=t(84542),ge=t(48860),ye=t(3421),fe=t(27502),ve=t(33687),he=t(59712);const be={LIMIT:{label:"LIMIT",index:0},CANCEL_LIMIT:{label:"CANCEL_LIMIT",index:1},SYSTEM_CANCEL:{label:"SYSTEM_CANCEL",index:2},OPEN:{label:"OPEN",index:3},CLOSE:{label:"CLOSE",index:4},TP:{label:"TP",index:5},SL:{label:"SL",index:6},LIQ:{label:"LIQUIDATED",index:7}},Pe=()=>{const{selectedNetworkId:e}=(0,ue.o6)(),i=(0,U.xx)({chainId:e}),{address:t,isConnected:o}=(0,U.mA)(),a=r((e=>e.appendHistory)),l=r((e=>e.resetHistory)),c=r((e=>e.predictionPage)),d=r((e=>e.appendPrediction)),u=r((e=>e.resetPrediction)),m=r((e=>e.refreshPrediction)),p=r((e=>e.setPredictionLoading)),g=r((e=>e.setPredictionHasMore)),y=r((e=>e.setPredictionPage)),f=(0,n.bC)({page:1,limit:10*c}),[v,h]=(0,s.useState)(!1),[b,P]=(0,s.useState)(!1),L=(0,s.useRef)(0),N=(0,s.useRef)(0),O=(0,de.D)((()=>(0,ce.__awaiter)(void 0,void 0,void 0,(function*(){if(!o||!t)return;if(b)return;P(!0);const{orderAndTradeHistories:e}=yield(({chainId:e,address:i,page:t=1,limit:s=10})=>(0,ce.__awaiter)(void 0,void 0,void 0,(function*(){const n=(0,pe.pT)(e);try{if(!i&&!n)return{order:null};const e=(0,ye.VH)(ge.IY,(null==n?void 0:n.apiNetwork)||"bnb"),o={query:"\n  query OrderAndTradeHistorys($skip: Int, $first: Int, $user: String) {\n    orderAndTradeHistories(\n        skip: $skip\n        first: $first\n        orderBy: timestamp\n        orderDirection: desc\n        where: { \n            user: $user\n            actionType_not: ADD_MARGIN\n        }\n    ) {\n        id\n        orderOrTradeHash\n        actionType\n        timestamp\n        txHash\n        limitOrder {\n            pair {\n                name\n            }\n            isLong\n            token {\n                symbol\n            }\n            amountIn\n            limitPrice\n            qty\n            takeProfit\n            stopLoss\n        }\n        trade {\n            pair {\n                name\n            }\n            isLong\n            token {\n                symbol\n            }\n            margin\n            entryPrice\n            qty\n            openFee\n            executionFee\n            closeType\n            closePrice\n            closeFee\n            fundingFee\n            holdingFee\n            pnl\n            actualPnl\n        }\n    }\n}\n",variables:{user:i,skip:t,first:s}},r={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(o)};return(0,fe.j)("graphql_request",{api:e,feature:"UserInfo/History",source:ve.brokerConfig.brokerId}),(yield(yield fetch(e,r)).json()).data}catch(e){return he.error(e),{order:null}}})))({chainId:i,address:t,page:10*L.current,limit:10}),s=e||[];L.current+=1,N.current+=s.length,P(!1),h(10*L.current<=N.current);const n=s.filter((e=>"LIMIT"!==e.actionType)).map((e=>{var i,t,s,n,o,r,a,l,c,d,u,m,p,g;const y=be[e.actionType]||{},f={hash:`${e.orderOrTradeHash}-${e.timestamp}-${y.index}`,timestamp:`${e.timestamp}000`,actionType:y.label,side:"LONG",pair:"",tokenSymbol:"",isLong:!1,qty:"",entryPrice:"",margin:"",closePrice:"",openFee:"",fundingFee:"",closeFee:"",executionFee:"",holdingFee:"",pnl:""};let v={};return v="CANCEL_LIMIT"===e.actionType||"SYSTEM_CANCEL"===e.actionType?{pair:e.limitOrder.pair.name.replace("/",""),isLong:e.limitOrder.isLong,side:e.limitOrder.isLong?"LONG":"SHORT",tokenSymbol:e.limitOrder.token.symbol}:{pair:null===(i=e.trade)||void 0===i?void 0:i.pair.name.replace("/",""),isLong:null===(t=e.trade)||void 0===t?void 0:t.isLong,side:(null===(s=e.trade)||void 0===s?void 0:s.isLong)?"LONG":"SHORT",qty:null===(n=e.trade)||void 0===n?void 0:n.qty,entryPrice:null===(o=e.trade)||void 0===o?void 0:o.entryPrice,closePrice:null===(r=e.trade)||void 0===r?void 0:r.closePrice,margin:null===(a=e.trade)||void 0===a?void 0:a.margin,openFee:null===(l=e.trade)||void 0===l?void 0:l.openFee,executionFee:null===(c=e.trade)||void 0===c?void 0:c.executionFee,fundingFee:null===(d=e.trade)||void 0===d?void 0:d.fundingFee,closeFee:null===(u=e.trade)||void 0===u?void 0:u.closeFee,holdingFee:null===(m=e.trade)||void 0===m?void 0:m.holdingFee,pnl:null===(p=e.trade)||void 0===p?void 0:p.pnl,tokenSymbol:null===(g=e.trade)||void 0===g?void 0:g.token.symbol},Object.assign(Object.assign(Object.assign({},e),f),v)}));a(n)}))));(0,s.useEffect)((()=>{o||(a([]),d([]))}),[a,d,o]),(0,s.useEffect)((()=>(o&&O(),()=>{o&&(l(),u(),L.current=0,N.current=0)})),[o]);const w=(0,de.D)((()=>(0,ce.__awaiter)(void 0,void 0,void 0,(function*(){p(!0);const e=yield(0,me.Q)({account:t,chainId:i,page:c+1,limit:10});e.success?(d(e.data),y(c+1)):g(!1),p(!1)}))));return(0,s.useEffect)((()=>(o&&t?H.ee.on("FETCH_DUMB_HISTORY_LIST",w):H.ee.off("FETCH_DUMB_HISTORY_LIST",w),()=>{H.ee.off("FETCH_DUMB_HISTORY_LIST",w)})),[t,o,w]),(0,s.useEffect)((()=>{f.data&&f.data.success&&m(f.data.data)}),[m,f]),(0,s.useMemo)((()=>({loadMore:O,hasMore:v,loadMoreLoading:b})),[O,v,b])}},74532:(e,i,t)=>{"use strict";t.d(i,{d0:()=>y,SD:()=>h,ch:()=>L,uT:()=>N,PH:()=>O,v_:()=>w,iA:()=>E,a1:()=>F,Ub:()=>B,Gc:()=>k,Jo:()=>Z,M2:()=>$,CE:()=>U,ls:()=>j,yi:()=>c,uY:()=>d});var s=t(52983),n=t(67387),o=t(49229),r=t(17921),a=t(25048);const l=(0,t(76748).Ue)((e=>({initialed:!1,orders:[],orderMap:{},initialOrders(i){e((0,a.ZP)((e=>{e.initialed=!0,e.orders=i.map((e=>e.hash)),e.orderMap=i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.hash]:i})),{})})))},addAOrder(i){e((0,a.ZP)((e=>{e.orders.push(i.hash),e.orderMap[i.hash]=i})))},deleteAOrderByHash(i){e((0,a.ZP)((e=>{delete e.orderMap[i],e.orders=e.orders.filter((e=>e!==i))})))}}))),c=()=>l((e=>e.orders)),d=()=>l((e=>e.initialed)),u=(e,i)=>l((t=>{var s,n;return null===(n=null===(s=t.orderMap)||void 0===s?void 0:s[e])||void 0===n?void 0:n[i]})),m=e=>{const i=u(e,"amountIn"),t=u(e,"tokenIn"),a=(0,n.QG)(t),l=(0,n.At)(t),c=(0,n.RK)(l),d=l&&void 0!==a;return(0,s.useMemo)((()=>({initialed:d,symbol:l,decimals:a,address:t,tokenIn:t,amountIn:new r.Z((0,o.mb)(i,a)),qtyPrecision:c})),[d,l,a,t,i,c])},p=e=>{const{symbol:i}=m(e),t=(0,n.Ms)(i);return(0,s.useMemo)((()=>t),[t])};var g=t(98277);const y=()=>{const{symbol:e}=(0,g.Dp)(),i=(0,n.d0)();return(0,s.useCallback)((t=>{var s;t!==e&&(i({isBlank:!1,stateSymbol:t}),null===(s=document.querySelector("#orderForm"))||void 0===s||s.scrollIntoView({behavior:"smooth"}))}),[i,e])};var f=t(42249),v=t(30883);const h=e=>{const i=(e=>{const{amountIn:i}=m(e);return(0,s.useMemo)((()=>new r.Z(i)),[i])})(e),t=(0,f.h)(),{initialed:n,symbol:o,qtyPrecision:a}=m(e);return(0,s.useMemo)((()=>n&&i.isFinite()?`${(0,v.uf)(i,a)} ${t[o]||o}`:"-"),[i,n,o,a,t])};var b=t(95386);const P=e=>{const i=u(e,"qty"),t=u(e,"limitPrice"),{initialed:a,amountIn:l}=m(e),c=(e=>{const i=u(e,"qty"),t=u(e,"pairBase"),a=u(e,"limitPrice"),{data:l}=(0,n.Bu)(t,{watch:!0});return(0,s.useMemo)((()=>l&&l.feeConfig&&l.feeConfig.openFeeP?new r.Z(i).multipliedBy(a).multipliedBy((0,o.mb)(l.feeConfig.openFeeP,b.cB.percent)):"-"),[l,a,i])})(e),{data:d}=(0,n.VT)(),{symbol:g,index:y}=p(e),f=g&&a;return(0,s.useMemo)((()=>f?new r.Z(i).multipliedBy(t).dividedBy(new r.Z(l).multipliedBy(y).minus(c).minus((0,o.mb)(null==d?void 0:d.executionFeeUsd.toString(),b.cB.usd))):new r.Z(1/0)),[f,i,t,l,y,c,null==d?void 0:d.executionFeeUsd])},L=e=>{const i=P(e);return(0,s.useMemo)((()=>i.isFinite()?`${i.toFixed(1)}x`:"-"),[i])},N=e=>{const i=u(e,"limitPrice"),t=u(e,"pair"),o=(0,n.fV)(t);return(0,s.useMemo)((()=>{const e=new r.Z(i);return e.isFinite()?(0,v.uf)(e,o):"-"}),[i,o])},O=e=>{const i=u(e,"pair"),t=(0,n.fV)(i),{close:o}=(0,n.Le)(i);return(0,s.useMemo)((()=>{const e=new r.Z(o);return e.isFinite()?(0,v.uf)(e,t):"-"}),[o,t])},w=e=>{const i=u(e,"qty"),t=u(e,"limitPrice");return(0,s.useMemo)((()=>{const e=new r.Z(i).multipliedBy(t);return e.isFinite()?e.toFixed(1):"-"}),[t,i])},E=e=>{const i=u(e,"pair"),t=u(e,"isLong"),{productMap:n}=(0,g.GS)();return(0,s.useMemo)((()=>{var e,s;return{symbol:i,isLong:t,symbolType:null===(e=n[i])||void 0===e?void 0:e.symbolType,symbolName:null===(s=n[i])||void 0===s?void 0:s.symbolName}}),[t,i,n])},F=e=>{const i=u(e,"takeProfit"),t=u(e,"stopLoss"),o=u(e,"pair"),a=(0,n.fV)(o);return(0,s.useMemo)((()=>{const e=new r.Z(i),s=new r.Z(t);return{takeProfit:e.isFinite()?(0,v.uf)(e,a):"-",stopLoss:s.isFinite()&&!s.isEqualTo(0)?(0,v.uf)(s,a):"-"}}),[a,t,i])},B=e=>{const i=u(e,"limitPrice"),t=u(e,"side"),a=u(e,"pair"),l=(0,n.fV)(a),c=(e=>{const i=u(e,"pair"),t=u(e,"pairBase"),a=u(e,"isLong"),l=u(e,"qty"),{close:c}=(0,n.Le)(i),{data:d}=(0,n.Bu)(t),{data:m}=(0,n.Jg)(t);return(0,s.useMemo)((()=>{if(d&&m){const{slippageType:e,onePercentDepthAboveUsd:i,onePercentDepthBelowUsd:t,slippageLongP:s,slippageShortP:n}=d.slippageConfig||{},{longQty:u,shortQty:p}=m;if(1===e)return a?new r.Z(l).multipliedBy(c).plus(new r.Z((0,o.mb)(u.toString(),b.cB.qty)).multipliedBy(c)).dividedBy((0,o.mb)(i.toString(),b.cB.usd)).toFixed(4,r.Z.ROUND_UP):new r.Z(l).multipliedBy(c).plus(new r.Z((0,o.mb)(p.toString(),b.cB.qty)).multipliedBy(c)).dividedBy((0,o.mb)(t.toString(),b.cB.usd)).toFixed(4,r.Z.ROUND_UP);if(0===e)return a?(0,o.mb)(s.toString(),b.cB.percent):(0,o.mb)(n.toString(),b.cB.percent);if(2===e){const e=new r.Z(l).multipliedBy(c),d=new r.Z((0,o.mb)(u.toString(),b.cB.qty)).multipliedBy(c),m=new r.Z((0,o.mb)(p.toString(),b.cB.qty)).multipliedBy(c),g=(0,o.mb)((a?i:t).toString(),b.cB.usd),y=new r.Z((0,o.mb)((a?s:n).toString(),b.cB.percent)),f=(a?e.minus(m).plus(d):e.minus(d).plus(m)).dividedBy(g);return r.Z.max(f,y).toFixed(4,r.Z.ROUND_UP)}return NaN}return NaN}),[a,c,m,d,l])})(e),d=(0,s.useMemo)((()=>"LONG"===t),[t]);return(0,s.useMemo)((()=>{const e=d?new r.Z(i).multipliedBy(new r.Z(1).minus(c)):new r.Z(i).multipliedBy(new r.Z(1).plus(c));return e.isFinite()?(0,v.uf)(e,l):"-"}),[d,i,l,c])};var M=t(76398),T=t(60103),_=t(51616),S=t(28006),D=t(17845),I=t(96988);const k=()=>{const{setDisabled:e}=(0,g.a9)(),{getI18n:i}=(0,I.V6)(),{submit:t}=(0,T.t)({getI18n:i}),o=(0,n.E4)(),r="cancelLimitOrder",{writeAsync:a}=(0,_.GG)(Object.assign(Object.assign({},o),{mode:"recklesslyUnprepared",functionName:r}));return(0,s.useCallback)((i=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){e(!0);try{const e=[i],s=yield(0,S.$q)(Object.assign(Object.assign({},o),{functionName:r,args:e})),{gasLimit:n}=s.request;yield t((()=>null==a?void 0:a({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,v.zb)(n)}}))),D.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}return e(!1),!0}))),[o,t,a,e])},x=new(t(58407).v);var C=t(59712);const Z=()=>{const{getI18n:e}=(0,I.V6)(),{setDisabled:i}=(0,g.a9)(),t=(0,n.E4)(),{submit:a}=(0,T.t)({getI18n:e}),{writeAsync:l}=(0,_.GG)(Object.assign(Object.assign({},t),{mode:"recklesslyUnprepared",functionName:"updateOrderTpAndSl"})),{writeAsync:c}=(0,_.GG)(Object.assign(Object.assign({},t),{mode:"recklesslyUnprepared",functionName:"updateOrderTp"})),{writeAsync:d}=(0,_.GG)(Object.assign(Object.assign({},t),{mode:"recklesslyUnprepared",functionName:"updateOrderSl"}));(0,s.useEffect)((()=>x.on("UPDATE_ORDER_TP_SL",(e=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,takeProfit:n,stopLoss:c,closeModalCallBack:d}=e;i(!0),C.debug("updateOrderTpAndSl",s,n,c);try{const e=[s,(0,o.r0)(n,b.cB.price),new r.Z(c).isEqualTo(0)||new r.Z(c).isNaN()?0:(0,o.r0)(c,b.cB.price)],i=yield(0,S.$q)(Object.assign(Object.assign({},t),{functionName:"updateOrderTpAndSl",args:e})),{gasLimit:u}=i.request;yield a((()=>null==l?void 0:l({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,v.zb)(u)}})),{onUserConfirm(){null==d||d()}}),D.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}i(!1)}))))),[t,a,l,i]),(0,s.useEffect)((()=>x.on("UPDATE_ORDER_TP",(e=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,takeProfit:n,closeModalCallBack:r}=e;i(!0),C.debug("updateOrderTp",s,n);try{const e=[s,(0,o.r0)(n,b.cB.price)],i=yield(0,S.$q)(Object.assign(Object.assign({},t),{functionName:"updateOrderTp",args:e})),{gasLimit:l}=i.request;yield a((()=>null==c?void 0:c({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,v.zb)(l)}})),{onUserConfirm(){null==r||r()}}),D.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}i(!1)}))))),[t,a,c,i]),(0,s.useEffect)((()=>x.on("UPDATE_ORDER_SL",(e=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,stopLoss:n,closeModalCallBack:l}=e;i(!0),C.debug("updateOrderSl",s,n);try{const e=[s,new r.Z(n).isEqualTo(0)||new r.Z(n).isNaN()?0:(0,o.r0)(n,b.cB.price)],i=yield(0,S.$q)(Object.assign(Object.assign({},t),{functionName:"updateOrderSl",args:e})),{gasLimit:c}=i.request;yield a((()=>null==d?void 0:d({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,v.zb)(c)}})),{onUserConfirm(){null==l||l()}}),D.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}i(!1)}))))),[t,a,d,i])},H=()=>(0,s.useMemo)((()=>({updateTpAndSl:({hash:e,takeProfit:i,stopLoss:t},s)=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){x.emit("UPDATE_ORDER_TP_SL",{hash:e,takeProfit:i,stopLoss:t,closeModalCallBack:s})})),updateTp:({hash:e,takeProfit:i},t)=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){x.emit("UPDATE_ORDER_TP",{hash:e,takeProfit:i,closeModalCallBack:t})})),updateSl:({hash:e,stopLoss:i},t)=>(0,M.__awaiter)(void 0,void 0,void 0,(function*(){x.emit("UPDATE_ORDER_SL",{hash:e,stopLoss:i,closeModalCallBack:t})}))})),[]);var R=t(87354);const A=e=>e.map((e=>{const i={orderHash:e.orderHash,broker:e.broker,pair:e.pair.replace("/",""),pairBase:e.pairBase,isLong:e.isLong,tokenIn:e.tokenIn,amountIn:e.amountIn.toString(),qty:(0,o.mb)(e.qty.toString(),b.cB.qty),limitPrice:(0,o.mb)(e.limitPrice.toString(),b.cB.price),stopLoss:(0,o.mb)(e.stopLoss.toString(),b.cB.price),takeProfit:(0,o.mb)(e.takeProfit.toString(),b.cB.price),timestamp:`${e.timestamp}000`,hash:e.orderHash,side:e.isLong?"LONG":"SHORT"};return Object.assign(Object.assign({},e),i)})).sort(((e,i)=>Number(i.timestamp)-Number(e.timestamp))),$=()=>{const e=(0,n.E4)(),{address:i,isConnected:t}=(0,_.mA)(),o=l((e=>e.initialOrders)),r=d(),{data:a=[],refetch:c,isSuccess:u,isFetching:m}=(0,_.do)(Object.assign(Object.assign({},e),{functionName:"getLimitOrders",args:[i,"0x0000000000000000000000000000000000000000"],enabled:t,cacheOnBlock:!0,cacheTime:R.g_}));(0,s.useEffect)((()=>{t||o([])}),[o,t]),(0,s.useEffect)((()=>{u&&!r&&o(A(a))}),[a,o,u,r]),(0,s.useEffect)((()=>{r&&!m&&o(A(a))}),[a,o,m,r]),(0,s.useEffect)((()=>D.ee.on("REFETCH_ORDER_LIST",(()=>{c()}))),[c])},U=e=>{const{close:i}=(0,n.Le)(e);return(0,s.useMemo)((()=>i),[i])};var q=t(55372);const j=e=>{const i=(0,f.h)(),t=u(e,"qty"),a=u(e,"limitPrice"),l=u(e,"side"),c=u(e,"pair"),d=u(e,"takeProfit"),g=u(e,"stopLoss"),y=(0,n.fV)(c),h=P(e),{data:L}=(0,n.VT)(),{index:N}=p(e),{qtyPrecision:O,symbol:w}=m(e),E=(0,s.useMemo)((()=>"LONG"===l),[l]),F=(0,s.useMemo)((()=>O),[O]),B=(0,s.useMemo)((()=>2),[]),M=(0,s.useMemo)((()=>E?(null==L?void 0:L.maxTakeProfitP)?(0,o.mb)(L.maxTakeProfitP,b.cB.percent):"Infinity":(null==L?void 0:L.maxTakeProfitP)?r.Z.minimum(new r.Z(h),(0,o.mb)(L.maxTakeProfitP,b.cB.percent)).toString():"Infinity"),[E,h,null==L?void 0:L.maxTakeProfitP]),T=(e=>{const i=u(e,"qty"),t=u(e,"pairBase"),a=u(e,"limitPrice"),l=(0,s.useMemo)((()=>new r.Z(i).multipliedBy(a)),[a,i]),c=(0,n.tz)(t,l);return(0,s.useMemo)((()=>(0,o.mb)(null==c?void 0:c.liqLostP,b.cB.percent)),[c])})(e),_=(0,q.D)((e=>E?new r.Z(e).multipliedBy(N).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).dividedBy(t)))),S=(0,q.D)((e=>E?new r.Z(e).minus(a).multipliedBy(t).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).dividedBy(N))),D=(0,q.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(h).dividedBy(N))),I=(0,q.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(h).dividedBy(new r.Z(t).multipliedBy(a)))),k=(0,q.D)((e=>E?new r.Z(e).multipliedBy(N).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).dividedBy(t)))),x=(0,q.D)((e=>E?new r.Z(e).minus(a).multipliedBy(t).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).dividedBy(N))),C=(0,q.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(h).dividedBy(N))),Z=(0,q.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(h).dividedBy(new r.Z(t).multipliedBy(a)))),R=(0,q.D)((e=>`${(0,v.uf)(e,F)} ${i[w]||w}`)),A=(0,q.D)((e=>(0,v.uf)(e,B))),$=(0,q.D)((e=>(0,v.uf)(e,y)));return(0,s.useMemo)((()=>({getTakeProfitPrice:_,getTakeProfitPNL:S,getTakeProfitPNLByROI:D,getTakeProfitROI:I,getStopLossPrice:k,getStopLossPNL:x,getStopLossPNLByROI:C,getStopLossROI:Z,pair:c,takeProfit:d,stopLoss:g,pricePrecision:y,PNLPrecision:F,ROIPrecision:B,side:l,maxTakeProfitROI:M,minStopLossROI:(-T).toString(),entryPrice:a,formatPNL:R,formatROI:A,formatPrice:$,useContractUpdateTPSL:H})),[_,S,D,I,k,x,C,Z,c,d,g,y,F,B,l,M,T,a,R,A,$])}},96240:(e,i,t)=>{"use strict";t.d(i,{d0:()=>b,SD:()=>N,A4:()=>O,ch:()=>F,lW:()=>S,PH:()=>D,RM:()=>k,v_:()=>x,iA:()=>C,a1:()=>Z,eO:()=>V,h2:()=>ee,Im:()=>X,Jo:()=>te,mM:()=>ne,D:()=>le,OB:()=>de,rf:()=>E,CE:()=>ue,zS:()=>ge,KB:()=>Fe,d:()=>c,mO:()=>Me,$J:()=>d,Zm:()=>u,ZC:()=>g,kD:()=>y,Gn:()=>p});var s=t(52983),n=t(67387),o=t(49229),r=t(17921),a=t(25048);const l=(0,t(76748).Ue)((e=>({initialed:!1,positions:[],positionMap:{},initialPositions(i){e((0,a.ZP)((e=>{e.initialed=!0,e.positions=i.map((e=>e.hash)),e.positionMap=i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.hash]:i})),{})})))},addAPosition(i){e((0,a.ZP)((e=>{e.positions.push(i.hash),e.positionMap[i.hash]=i})))},deleteAPositionByHash(i){e((0,a.ZP)((e=>{delete e.positionMap[i],e.positions=e.positions.filter((e=>e!==i))})))},updateAPosition(i,t,s){e((0,a.ZP)((e=>{if(e.positionMap[i]){const n=e.positionMap[i];e.positionMap[i]=Object.assign(Object.assign({},n),{[t]:s})}})))},predictionInitialed:!1,predictions:[],predictionMap:{},initialPredictions(i){e((0,a.ZP)((e=>{e.predictionInitialed=!0,e.predictions=i.map((e=>e.positionHash)),e.predictionMap=i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.positionHash]:i})),{})})))},addAPrediction(i){e((0,a.ZP)((e=>{e.predictions.push(i.positionHash),e.predictionMap[i.positionHash]=i})))},deleteAPredictionByHash(i){e((0,a.ZP)((e=>{delete e.predictionMap[i],e.predictions=e.predictions.filter((e=>e!==i))})))}}))),c=()=>{const e=l((e=>e.positions)),i=l((e=>e.predictions));return e.length+i.length},d=()=>l((e=>e.positions)),u=()=>l((e=>e.initialed)),m=(e,i)=>l((t=>{var s,n;return null===(n=null===(s=t.positionMap)||void 0===s?void 0:s[e])||void 0===n?void 0:n[i]})),p=()=>l((e=>e.predictions)),g=(e,i)=>l((t=>{var s,n;return null===(n=null===(s=t.predictionMap)||void 0===s?void 0:s[e])||void 0===n?void 0:n[i]})),y=()=>l((e=>e.predictionInitialed)),f=e=>{const i=m(e,"margin"),t=m(e,"marginToken"),a=(0,n.QG)(t),l=(0,n.At)(t),c=(0,n.RK)(l),d=l&&void 0!==i&&void 0!==a;return(0,s.useMemo)((()=>({initialed:d,symbol:l,decimals:a,margin:new r.Z((0,o.mb)(i,a)),address:t,marginToken:t,qtyPrecision:c})),[d,l,a,i,t,c])},v=e=>{const{symbol:i}=f(e),t=(0,n.Ms)(i);return(0,s.useMemo)((()=>t),[t])};var h=t(98277);const b=()=>{const{symbol:e}=(0,h.Dp)(),i=(0,n.d0)();return(0,s.useCallback)((t=>{var s;t!==e&&(i({isBlank:!1,stateSymbol:t}),null===(s=document.querySelector("#orderForm"))||void 0===s||s.scrollIntoView({behavior:"smooth"}))}),[i,e])};var P=t(42249),L=t(30883);const N=e=>{const i=(0,P.h)(),{initialed:t,margin:n,symbol:o,qtyPrecision:r}=f(e);return(0,s.useMemo)((()=>t&&n.isFinite()?`${(0,L.uf)(n,r)} ${i[o]||o}`:"-"),[t,n,r,o,i])},O=e=>{const i=m(e,"pair"),t=m(e,"entryPrice"),o=(0,n.fV)(i);return(0,s.useMemo)((()=>new r.Z(t).isFinite()?(0,L.uf)(t,o):"-"),[t,o])},w=e=>{const{symbol:i,index:t}=v(e),n=f(e);return(0,s.useMemo)((()=>Object.assign(Object.assign({},n),{initialed:n.initialed&&void 0!==i,margin:new r.Z(n.margin).multipliedBy(t)})),[t,n,i])},E=e=>{const i=m(e,"qty"),t=m(e,"entryPrice"),{margin:n,initialed:o}=w(e);return(0,s.useMemo)((()=>o?new r.Z(i).multipliedBy(t).dividedBy(n):new r.Z(1/0)),[t,n,i,o])},F=e=>{const i=E(e);return(0,s.useMemo)((()=>i.isFinite()?`${i.toFixed(1)}x`:"-"),[i])},B=e=>{const i=m(e,"openFee"),t=m(e,"executionFee"),n=m(e,"fundingFee"),r=m(e,"holdingFee"),{decimals:a}=f(e);return(0,s.useMemo)((()=>({openFee:(0,o.mb)(i,a),fundingFee:(0,o.mb)(n,a),executionFee:(0,o.mb)(t,a),holdingFee:(0,o.mb)(r,a)})),[a,t,n,r,i])},M=e=>{const{openFee:i,executionFee:t,fundingFee:n,holdingFee:o}=B(e),{symbol:a,index:l}=v(e);return(0,s.useMemo)((()=>({initialed:void 0!==a,openFee:new r.Z(i).multipliedBy(l),fundingFee:new r.Z(n).multipliedBy(l),executionFee:new r.Z(t).multipliedBy(l),holdingFee:new r.Z(o).multipliedBy(l)})),[t,n,o,l,i,a])};var T=t(95386);const _=e=>{const i=m(e,"qty"),t=m(e,"pairBase"),a=m(e,"entryPrice"),l=(0,s.useMemo)((()=>new r.Z(i).multipliedBy(a)),[a,i]),c=(0,n.tz)(t,l);return(0,s.useMemo)((()=>(0,o.mb)(null==c?void 0:c.liqLostP,T.cB.percent)),[c])},S=e=>{const i=m(e,"entryPrice"),t=m(e,"side"),o=m(e,"pair"),a=m(e,"qty"),l=(0,n.fV)(o),{initialed:c,fundingFee:d,holdingFee:u}=M(e),{initialed:p,margin:g}=w(e),y=_(e),f=c&&p,v=(0,s.useMemo)((()=>"LONG"===t),[t]),h=(0,s.useMemo)((()=>new r.Z(g).multipliedBy(y).plus(new r.Z(d).minus(u)).dividedBy(a)),[d,u,y,g,a]);return(0,s.useMemo)((()=>{const e=v?new r.Z(i).minus(h):new r.Z(i).plus(h);return f&&e.isFinite()?e.isNegative()?"-":(0,L.uf)(e,l):"-"}),[i,f,v,h,l])},D=e=>{const i=m(e,"pair"),t=(0,n.fV)(i),{close:o}=(0,n.Le)(i);return(0,s.useMemo)((()=>new r.Z(o).isFinite()?(0,L.uf)(o,t):"-"),[o,t])},I=e=>{const i=m(e,"qty"),t=m(e,"pair"),o=m(e,"entryPrice"),a=m(e,"side"),{index:l}=v(e),{fundingFee:c,holdingFee:d}=B(e),{margin:u}=f(e),{close:p}=(0,n.Le)(t),g=(0,s.useMemo)((()=>"LONG"===a),[a]),y=(0,s.useMemo)((()=>g?new r.Z(p).minus(o).multipliedBy(i).plus(c).dividedBy(l).plus(new r.Z(c).minus(d)):new r.Z(o).minus(p).multipliedBy(i).plus(c).dividedBy(l).plus(new r.Z(c).minus(d))),[o,c,d,l,g,p,i]),h=(0,s.useMemo)((()=>new r.Z(y).dividedBy(u)),[y,u]);return(0,s.useMemo)((()=>({PNL:y,ROI:h})),[y,h])},k=e=>{const i=(0,P.h)(),{PNL:t,ROI:n}=I(e),{initialed:o,symbol:r,qtyPrecision:a}=f(e);return(0,s.useMemo)((()=>{const e=(0,L.uf)(t,a),s=`${(0,L.uf)(n.multipliedBy(100),2)}%`,l=n.multipliedBy(100),c=t.isFinite(),d=n.isFinite(),u=t.isNegative(),m=t.gt(0),p=n.lt(0),g=i[r]||r;return{PNL:o&&c?u?`${e} ${g}`:`+${e} ${g}`:"-",ROI:o&&d?p?s:`+${s}`:"-",PNLAbbr:o&&c?`${u?"-":"+"}${(0,L.pF)(Math.abs(t.toNumber()),a)}`:"-",isPNLNegative:u,isPNLPositive:m,isROINegative:p,marginSymbol:g,ROIInNumber:l.toNumber()}}),[t,a,n,o,r,i])},x=e=>{const i=m(e,"qty"),t=m(e,"pair"),{close:o}=(0,n.Le)(t);return(0,s.useMemo)((()=>{const e=new r.Z(i).multipliedBy(o);return e.isFinite()?(0,L.uf)(e.toFixed(1),1):"-"}),[o,i])},C=e=>{const i=m(e,"pair"),t=m(e,"isLong"),{productMap:n}=(0,h.GS)();return(0,s.useMemo)((()=>{var e,s;return{symbol:i,isLong:t,symbolType:null===(e=n[i])||void 0===e?void 0:e.symbolType,symbolName:null===(s=n[i])||void 0===s?void 0:s.symbolName}}),[t,i,n])},Z=e=>{const i=m(e,"takeProfit"),t=m(e,"stopLoss"),o=m(e,"pair"),a=(0,n.fV)(o);return(0,s.useMemo)((()=>{const e=new r.Z(i),s=new r.Z(t);return{takeProfit:e.isFinite()?(0,L.uf)(e,a):"-",stopLoss:s.isFinite()&&!s.isEqualTo(0)?(0,L.uf)(s,a):"-"}}),[a,t,i])};var H=t(76398),R=t(60103),A=t(28006),$=t(13004),U=t(96988),q=t(17845);const j=new(t(58407).v);var G=t(59712);const V=()=>{const{track:e}=(0,n.B1)(),{getI18n:i}=(0,U.V6)(),{setDisabled:t}=(0,h.a9)(),{submit:o}=(0,R.t)({getI18n:i}),r=(0,n.E4)();(0,s.useEffect)((()=>j.on("ADD_MARGIN",(i=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,amount:n,closeModalCallBack:a,marginToken:l}=i;t(!0),G.debug("ADD_MARGIN",s,n),e("click_add_margin_classic_popup_button");try{const i=yield(0,A.$q)(Object.assign(Object.assign({},r),{functionName:"addMargin",args:[s,n],overrides:l?void 0:{value:$.O$.from(n)}}));yield o((()=>(0,A.n9)(Object.assign(Object.assign({},i),{request:Object.assign(Object.assign({},i.request),{gasLimit:(0,L.zb)(i.request.gasLimit)})}))),{onUserConfirm(){null==a||a()}}),e("add_margin_classic_success"),q.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(i){e("add_margin_classic_error")}t(!1)}))))),[r,t,o,e])};var z=t(85197),Y=t(51616),Q=t(8429),K=t(59712);const J=()=>{const e=l((e=>e.positionMap)),{productMap:i}=(0,h.GS)();return function(e){const i=(0,s.useRef)(e);i.current=e;return(0,s.useCallback)(((...e)=>("function"==typeof i.current?i.current:()=>{})(...e)),[])}((t=>{const{pair:s}=e[t]||{};return s?i[s]?(0,Q.L)(i[s].symbolType).isDegenMode:(K.error(`useIsDegenMode productMap can not found the pair by hash ${t} and pair ${s}`),!1):(K.error(`useIsDegenMode positionMap can not found the pair by hash ${t}`),!1)}))};var W=t(59712);const X=()=>{const{track:e}=(0,n.B1)(),{getI18n:i}=(0,U.V6)(),{setDisabled:t}=(0,h.a9)(),o=J(),{submit:r}=(0,R.t)({getI18n:i}),a=(0,n.E4)(),l="closeTrade",{writeAsync:c}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:l}));return(0,s.useCallback)((i=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){t(!0);const s=o(i);e(s?"click_close_degen_position_button":"click_close_classic_position_button");try{const t=[i],n=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:l,args:t})),{gasLimit:o}=n.request;yield r((()=>null==c?void 0:c({recklesslySetUnpreparedArgs:t,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(o)}})),{otherParams:{orderHash:i},secondConfirm:z.Xp,secondConfirmAddress:a.address}),e(s?"close_degen_position_success":"close_classic_position_success")}catch(i){e(s?"close_degen_position_error":"close_classic_position_error")}return q.ee.emit("REFETCH_POSITION_LIST",void 0),t(!1),!0}))),[t,o,e,a,r,c])},ee=()=>{const e=d(),{getI18n:i}=(0,U.V6)(),{setDisabled:t}=(0,h.a9)(),{submit:o}=(0,R.t)({getI18n:i}),r=(0,n.E4)(),a="batchCloseTrade",{writeAsync:l}=(0,Y.GG)(Object.assign(Object.assign({},r),{mode:"recklesslyUnprepared",functionName:a}));return(0,s.useCallback)((()=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){t(!0);try{const i=[[...e]],t=yield(0,A.$q)(Object.assign(Object.assign({},r),{functionName:a,args:i})),{gasLimit:s}=t.request;yield o((()=>null==l?void 0:l({recklesslySetUnpreparedArgs:i,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(s)}})),{otherParams:{orderHash:e.join(",")},secondConfirm:z.od,secondConfirmAddress:r.address})}catch(e){W.error(e)}return q.ee.emit("REFETCH_POSITION_LIST",void 0),t(!1),!0}))),[t,e,r,o,l])};var ie=t(59712);const te=()=>{const{getI18n:e}=(0,U.V6)(),{setDisabled:i}=(0,h.a9)(),{track:t}=(0,n.B1)(),a=(0,n.E4)(),{submit:l}=(0,R.t)({getI18n:e}),{writeAsync:c}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:"updateTradeTpAndSl"})),{writeAsync:d}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:"updateTradeTp"})),{writeAsync:u}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:"updateTradeSl"}));(0,s.useEffect)((()=>j.on("UPDATE_TRADE_TP_SL",(e=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,takeProfit:n,stopLoss:d,closeModalCallBack:u}=e,m=new r.Z(d);i(!0),ie.debug("updateTradeTpAndSl",s,n,d),t("class_position_edit_tpsl");try{const e=[s,(0,o.r0)(n,T.cB.price),m.isEqualTo(0)||!m.isFinite()?0:(0,o.r0)(d,T.cB.price)],i=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:"updateTradeTpAndSl",args:e})),{gasLimit:r}=i.request;yield l((()=>null==c?void 0:c({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(r)}})),{onUserConfirm(){null==u||u()}}),t("class_position_edit_tpsl_success"),q.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(e){t("class_position_edit_tpsl_error")}i(!1)}))))),[a,l,c,i,t]),(0,s.useEffect)((()=>j.on("UPDATE_TRADE_TP",(e=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,takeProfit:n,closeModalCallBack:r}=e;i(!0),ie.debug("updateTradeTp",s,n),t("class_position_edit_tpsl");try{const e=[s,(0,o.r0)(n,T.cB.price)],i=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:"updateTradeTp",args:e})),{gasLimit:c}=i.request;yield l((()=>null==d?void 0:d({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(c)}})),{onUserConfirm(){null==r||r()}}),t("class_position_edit_tpsl_success"),q.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(e){t("class_position_edit_tpsl_error")}i(!1)}))))),[a,l,d,i,t]),(0,s.useEffect)((()=>j.on("UPDATE_TRADE_SL",(e=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:s,stopLoss:n,closeModalCallBack:c}=e,d=new r.Z(n);i(!0),ie.debug("updateTradeSl",s,n),t("class_position_edit_tpsl");try{const e=[s,d.isEqualTo(0)||!d.isFinite()?0:(0,o.r0)(n,T.cB.price)],i=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:"updateTradeSl",args:e})),{gasLimit:r}=i.request;yield l((()=>null==u?void 0:u({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(r)}})),{onUserConfirm(){null==c||c()}}),t("class_position_edit_tpsl_success"),q.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(e){t("class_position_edit_tpsl_error")}i(!1)}))))),[a,l,u,i,t])},se=()=>(0,s.useMemo)((()=>({updateTpAndSl:({hash:e,takeProfit:i,stopLoss:t,closeModalCallBack:s})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("UPDATE_TRADE_TP_SL",{hash:e,takeProfit:i,stopLoss:t,closeModalCallBack:s})})),updateTp:({hash:e,takeProfit:i,closeModalCallBack:t})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("UPDATE_TRADE_TP",{hash:e,takeProfit:i,closeModalCallBack:t})})),updateSl:({hash:e,stopLoss:i,closeModalCallBack:t})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("UPDATE_TRADE_SL",{hash:e,stopLoss:i,closeModalCallBack:t})}))})),[]),ne=e=>{const i=g(e,"symbol"),t=(0,n.fV)(i),{close:o}=(0,n.Le)(i);return(0,s.useMemo)((()=>new r.Z(o).isFinite()?(0,L.uf)(o,t):"-"),[o,t])};var oe=t(87354),re=t(14369),ae=t(58851);const le=()=>{const{data:e}=(0,re.R)(),i=(0,Y.NL)();return{useHistoryTab:ae.g8,refetchPredictions:()=>{i.invalidateQueries([oe.ac.DumbPositionList])},usePredictionDataByFiled:g,usePredictionInitialed:y,usePredictions:p,usePricePrecision:n.fV,useAssetPrecision:n.RK,useCurrentPrice:ne,predictionPairs:e}},ce=e=>e.map((e=>{const i={positionHash:e.positionHash,pair:e.pair.replace("/",""),pairBase:e.pairBase,marginToken:e.marginToken,isLong:e.isLong,hash:e.positionHash,entryPrice:(0,o.mb)(e.entryPrice.toString(),T.cB.price),qty:(0,o.mb)(e.qty.toString(),T.cB.qty),stopLoss:(0,o.mb)(e.stopLoss.toString(),T.cB.price),takeProfit:(0,o.mb)(e.takeProfit.toString(),T.cB.price),timestamp:`${e.timestamp}000`,side:e.isLong?"LONG":"SHORT",margin:e.margin.toString(),executionFee:e.executionFee.toString(),fundingFee:e.fundingFee.toString(),openFee:e.openFee.toString(),holdingFee:e.holdingFee.toString(),tokenIn:e.tokenIn};return Object.assign(Object.assign({},e),i)})).sort(((e,i)=>Number(i.timestamp)-Number(e.timestamp))),de=()=>{const e=(0,n.E4)(),{address:i,isConnected:t}=(0,Y.mA)(),o=u(),r=l((e=>e.initialPositions)),a=l((e=>e.initialPredictions)),{data:c}=(0,n.XB)({}),{data:d=[],refetch:m,isSuccess:p,isFetching:g}=(0,Y.do)(Object.assign(Object.assign({},e),{functionName:"getPositionsV2",args:[i,"0x0000000000000000000000000000000000000000"],enabled:t,cacheOnBlock:!0,cacheTime:oe.g_}));(0,s.useEffect)((()=>{t||(r([]),a([]))}),[r,a,t]),(0,s.useEffect)((()=>{p&&!o&&r(ce(d))}),[d,r,p,o]),(0,s.useEffect)((()=>{o&&!g&&r(ce(d))}),[d,r,g,o]),(0,s.useEffect)((()=>(q.ee.on("REFETCH_POSITION_LIST",m),()=>{q.ee.off("REFETCH_POSITION_LIST",m)})),[m]),(0,s.useEffect)((()=>{c&&c.success&&a(c.data)}),[a,c])},ue=e=>{const{close:i}=(0,n.Le)(e);return(0,s.useMemo)((()=>i),[i])};var me=t(54872);const pe=()=>(0,s.useMemo)((()=>({addMargin:({hash:e,amount:i,closeModalCallBack:t,marginToken:s})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("ADD_MARGIN",{hash:e,amount:i,closeModalCallBack:t,marginToken:s})}))})),[]),ge=e=>{const{getI18n:i}=(0,U.V6)(),t=m(e,"qty"),o=m(e,"isLong"),a=m(e,"entryPrice"),l=m(e,"pair"),{index:c}=v(e),d=_(e),{fundingFee:u}=M(e),p=(0,n.fV)(l),{marginToken:g,margin:y,qtyPrecision:h}=f(e),b=(0,s.useCallback)((e=>new r.Z(y).plus(e)),[y]),P=(0,s.useCallback)((e=>new r.Z(t).multipliedBy(a).dividedBy(new r.Z(e).multipliedBy(c))),[a,c,t]),N=(0,s.useCallback)((e=>{const i=new r.Z(e).multipliedBy(d).multipliedBy(c).plus(u).dividedBy(t);return o?new r.Z(a).minus(i):new r.Z(a).plus(i)}),[a,u,c,o,d,t]);return(0,s.useMemo)((()=>({symbol:l,side:o?i("userinfo-positions-side-LONG","Long"):i("userinfo-positions-side-SHORT","Short"),isLong:o,marginToken:g,marginQtyPrecision:h,pricePrecision:p,formatNumber:L.uf,calcMargin:b,calcLeverage:P,calcLiqPrice:N,useTokenApprove:me.Z,useContractAddMargin:pe})),[l,o,i,g,h,p,b,P,N])};var ye=t(34338);const fe=e=>{const i=m(e,"timestamp"),{getI18n:t}=(0,U.V6)();return(0,s.useMemo)((()=>(0,L.jE)(Number(i),t)),[i,t])},ve=e=>{const{executionFee:i}=B(e),{executionFee:t}=M(e),{symbol:n,qtyPrecision:o}=f(e);return(0,s.useMemo)((()=>`${(0,L.FL)(new r.Z(i),o)} ${n} ( ≈ ${(0,L.uf)(t,2)} USD )`),[i,o,n,t])},he=e=>{const i=(0,P.h)(),{fundingFee:t,holdingFee:n}=B(e),{fundingFee:o,holdingFee:a}=M(e),{symbol:l,qtyPrecision:c}=f(e);return(0,s.useMemo)((()=>{const e=new r.Z(t).minus(n);return{fundingFee:`${e.isNegative()?"":"+"}${(0,L.FL)(e,c)} ${i[l]||l} ( ≈ ${(0,L.uf)(new r.Z(o).minus(a),2)} USD )`,isFundingFeeNegative:e.isNegative()}}),[t,n,c,l,o,a,i])},be=e=>{const i=(0,P.h)(),{symbol:t,qtyPrecision:n}=f(e),o=(e=>{const{margin:i}=f(e);return(0,s.useMemo)((()=>i),[i])})(e),{margin:r}=w(e);return(0,s.useMemo)((()=>`${(0,L.FL)(o,n)} ${i[t]||t} ( ≈ ${(0,L.uf)(r,1)} USD )`),[o,n,t,r,i])},Pe=e=>{const{PNL:i}=I(e),{openFee:t,executionFee:s}=B(e);return i.minus(t).minus(s)},Le=e=>{const i=(0,P.h)(),{symbol:t,qtyPrecision:n}=f(e),o=Pe(e),r=(e=>{const i=Pe(e),{index:t}=v(e);return i.multipliedBy(t)})(e);return(0,s.useMemo)((()=>({netProfit:o.isNaN()?"-":`${o.isNegative()?"":"+"}${(0,L.FL)(o,n)} ${i[t]||t} ( ≈ ${(0,L.uf)(r,1)} USD )`,isNetProfitNegative:o.isNegative()})),[o,n,t,r,i])},Ne=e=>{const i=(0,P.h)(),{openFee:t}=B(e),{openFee:n}=M(e),{symbol:o,qtyPrecision:a}=f(e);return(0,s.useMemo)((()=>`${(0,L.FL)(new r.Z(t),a)} ${i[o]||o} ( ≈ ${(0,L.uf)(n,2)} USD )`),[t,a,o,n,i])},Oe=e=>{const i=m(e,"pair"),t=(0,h.Lh)(i,"baseAsset");return(0,s.useMemo)((()=>({pair:i,baseAsset:t})),[i,t])},we=e=>{const i=(0,P.h)(),{symbol:t,qtyPrecision:n}=f(e),{index:o}=v(e),{PNL:r,ROI:a}=I(e);return(0,s.useMemo)((()=>{const e=(0,L.FL)(r,n),s=`${(0,L.uf)(a.multipliedBy(100),2)}%`,l=r.isFinite(),c=a.isFinite(),d=r.isNegative(),u=r.gt(0),m=a.isNegative(),p=i[t]||t;return{PNL:l?`${d?"":"+"}${e} ${p} ( ≈ ${(0,L.uf)(r.multipliedBy(o),1)} USD\n      )`:"-",PNLOrigin:r,PNLFormatted:e,ROI:c?m?s:`+${s}`:"-",isPNLNegative:d,isPNLPositive:u,isROINegative:m,marginSymbol:p}}),[r,a,n,o,t,i])},Ee=e=>{const i=x(e),t=m(e,"qty"),n=m(e,"pair"),o=(0,h.Lh)(n,"quantityPrecision");return(0,s.useMemo)((()=>({size:i,qty:(0,L.uf)(t,o)})),[t,o,i])},Fe=()=>{const{track:e}=(0,ye.B)(),i=(0,s.useCallback)((i=>{e(i?"pv_degen_position_detail_popup":"pv_classic_position_detail_popup")}),[e]);return(0,s.useMemo)((()=>({usePositionDetailPair:Oe,usePositionDetailLeverage:F,usePositionDetailInitialMargin:be,usePositionDetailSymbol:C,usePositionDetailQtyAndSize:Ee,usePositionDetailFundingFee:he,usePositionDetailOpenFee:Ne,usePositionDetailExecutionFee:ve,usePositionDetailEntryPrice:O,usePositionDetailLiquidPrice:S,usePositionDetailLiqLostRate:_,usePositionDetailPNLROI:we,usePositionDetailNetProfit:Le,usePositionDetailDuration:fe,usePositionDetailPricePrecision:n.fV,onPositionDetailOpen:i,useIsDegenMode:J})),[i])};var Be=t(55372);const Me=e=>{const i=(0,P.h)(),t=m(e,"qty"),a=m(e,"entryPrice"),l=m(e,"side"),c=m(e,"pair"),d=m(e,"takeProfit"),u=m(e,"stopLoss"),p=(0,n.fV)(c),g=E(e),{fundingFee:y}=M(e),{data:h}=(0,n.VT)(),b=_(e),{index:N}=v(e),{qtyPrecision:O,symbol:w}=f(e),F=(0,s.useMemo)((()=>"LONG"===l),[l]),B=(0,s.useMemo)((()=>O),[O]),S=(0,s.useMemo)((()=>2),[]),D=(0,s.useMemo)((()=>F?(null==h?void 0:h.maxTakeProfitP)?(0,o.mb)(h.maxTakeProfitP,T.cB.percent):"Infinity":(null==h?void 0:h.maxTakeProfitP)?r.Z.minimum(new r.Z(g),(0,o.mb)(h.maxTakeProfitP,T.cB.percent)).toString():"Infinity"),[F,g,null==h?void 0:h.maxTakeProfitP]),I=(0,Be.D)((e=>F?new r.Z(e).multipliedBy(N).minus(y).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).minus(y).dividedBy(t)))),k=(0,Be.D)((e=>F?new r.Z(e).minus(a).multipliedBy(t).plus(y).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).plus(y).dividedBy(N))),x=(0,Be.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(g).dividedBy(N))),C=(0,Be.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(g).dividedBy(new r.Z(t).multipliedBy(a)))),Z=(0,Be.D)((e=>F?new r.Z(e).multipliedBy(N).minus(y).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).minus(y).dividedBy(t)))),H=(0,Be.D)((e=>F?new r.Z(e).minus(a).multipliedBy(t).plus(y).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).plus(y).dividedBy(N))),R=(0,Be.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(g).dividedBy(N))),A=(0,Be.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(g).dividedBy(new r.Z(t).multipliedBy(a)))),$=(0,Be.D)((e=>`${(0,L.uf)(e,B)} ${i[w]||w}`)),U=(0,Be.D)((e=>(0,L.uf)(e,S))),q=(0,Be.D)((e=>(0,L.uf)(e,p)));return(0,s.useMemo)((()=>({getTakeProfitPrice:I,getTakeProfitPNL:k,getTakeProfitPNLByROI:x,getTakeProfitROI:C,getStopLossPrice:Z,getStopLossPNL:H,getStopLossPNLByROI:R,getStopLossROI:A,pair:c,takeProfit:d,stopLoss:u,pricePrecision:p,PNLPrecision:B,ROIPrecision:S,maxTakeProfitROI:D,minStopLossROI:(-b).toString(),side:l,entryPrice:a,formatPNL:$,formatROI:U,formatPrice:q,useContractUpdateTPSL:se})),[B,S,a,$,q,U,H,R,Z,A,k,x,I,C,D,b,c,p,l,u,d])}},50291:(e,i,t)=>{"use strict";t.d(i,{T:()=>s});const s={positions:"positions",orders:"orders",history:"history"}}}]);