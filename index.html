<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Kromatika Perpetual Portal</title>
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/x-icon" href="favicon.ico" />
		<link rel="stylesheet" href="styles/styles.css"/>

		<script src="s3/sdk/sdk.1.9.0.js"></script>

		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-249910106-4"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-249910106-4');

		</script>
	</head>
	<body>

		<!-- The Modal -->
		<div id="myModal" class="modal">
			<!-- Modal content -->
			<div class="modal-content">
				<div id="modalContent">
					<p id="modalTitle">Disclaimer</p>
					<p id="modalSubtitle">
						Some countries may not be allowed to use perpetual trading
						portal - more details available in <a id="linkTOU" href="https://kromatika.finance/terms-of-use" target="_blank">Terms of Use, section 2</a>.
					</br></br>By clicking "Agree" you accept the Terms and Conditions by
						Kromatika.Finance
					</p>
					<div id="dontShow">
						<input type="checkbox" id="dontShowAgain"/>
						<p id="checkboxText">
							Don't show this message again for the next 30 days.
						</p>
					</div>
					<div
						id="agreeButtonWrapper"
					>
						<button
							id="closeBtn">
							I agree
						</button>
					</div>
				</div>
			</div>
		</div>
		<div id="app"></div>
		<script>
			// Get the button that opens the modal
			var btn = document.getElementById("closeBtn");
			var modal = document.getElementById("myModal");
			// When the user clicks on the button, open the modal
			btn.onclick = function () {
				//Check if checkbox is ticked
				if(dontShowAgain.checked)
				{
					// Set date of validation to local storage
					localStorage.setItem('KromApolloxTOUTicked', Date.now().toString())
				}
				modal.style.display = "none";
			};
			document.addEventListener("DOMContentLoaded", function(event) {
				//Check for already existing validation 
				const tickingDate = localStorage.getItem('KromApolloxTOUTicked')
				const millis = Date.now() - tickingDate
				if(!tickingDate || (Math.floor(millis / 1000 / 60 / 60 / 24) > 30) )
				{
					modal.style.display = "block";
				}
			})
			const { origin, protocol, pathname } = window.location;
			const isDev = protocol === "http:";
			
			FuturesSDK.createTradeUI({
				container: document.getElementById("app"),
				config: {
					isTestnet: false,
					staticBaseUrl: `${origin}/s3/static/`, // in production, you have to change this to your static base url
					apiBaseUrl: isDev ? `${origin}` : undefined, // in production, you don't need to configurate this, it's default as APX's url
					futuresWsHost: "wss://fstream.apollox.finance/compress",
					enableThemeToggle: false,
					supportLanguages: ['en', 'zh-CN'], // optional, default to all languages
					headerConfig: {
						disable: false,
						logo: {
							darkImgUrl: '/public/kromatika_logo.png',
							lightImgUrl: '/public/kromatika_logo.png',
							navTo: "https://app.kromatika.finance/#/pool",
						},
						token: {
							imgUrl: `https://static.coinpaprika.com/coin/krom-kromatikafinance/logo.png?rev=10691015`,
							navTo: 'https://coinmarketcap.com/currencies/kromatika/',
							lpPairAddress: '0x6ae0cdc5d2b89a8dcb99ad6b3435b3e7f7290077', 
							lpBaseAddress: '0x3af33bef05c2dcb3c7288b77fe1c8d2aeba4d789', 
							lpQuoteAddress: '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2', 
							network: 'eth',
							pricePrecision: 8,
						},
						customerService: {
							navTo: 'https://apollox.zendesk.com/hc/%lng%/requests/new',
						},
					},
					supportNetworks: ["bnb", "eth", "arb"],
					darkPalette: {
						primaryHover: "#7994f6", // background hover
						primary: "#7994f6", // background; text hover,
						
						badgeYellowBg: "#1E1F31",
					},
					loadingImage: {
						url: "/public/loading.gif",
					},
					defaultTheme: "dark",
					fontFamily: "Eina-Regular",
					fontUrl: "/public/fonts/Eina02-Regular.ttf",
				},
				state: {
					symbol: getSymbolFromUrl(),
					lng: getLngFromUrl(),
				},
			});
			FuturesSDK.eventListener.on('symbolChange', (data) => {
				window.history.replaceState({}, null, `/${getLngFromUrl()}/futures/${data.symbol}`);
			})
			FuturesSDK.eventListener.on('lngChange', (data) => {
				window.history.pushState({}, null, `/${data.lng}/futures/${getSymbolFromUrl()}`)
			})

			function getLngFromUrl() {
				return location.pathname.split('/')[1] || 'en'
			}

			function getSymbolFromUrl() {
				return location.pathname.split('/')[3] || 'BTCUSDT'
		}
      
		</script>
	</body>
</html>
